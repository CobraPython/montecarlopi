% ****** rbf.tex ******
% Este archivo provee el formato para la Revista Boliviana de Fisica, RBF.
\documentclass{rbf}
%\documentclass[onecolumn]{rbf}

\usepackage{amsmath}
\usepackage{natbib}
\usepackage[utf8]{inputenc}
%\usepackage[latin1]{inputenc}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\newcommand{\mr}{{\bf RBF: }}
\newcommand{\jim}{{\bf JY: }}

\begin{document}

\title{ESTUDIO DEL M√âTODO MONTE CARLO EN SIMULACIONES PARA LA ESTIMACI√ìN DEL VALOR DE PI}

\author{Juan Pablo Crespo Vargas\marca{*}}
\afil{Sensei Dojo Cobra Py, https://github.com/CobraPython}%

\alpie{*}{jp.crespo.vargas@gmail.com}% Las lineas se cortan automaticamente o puede obligarse esto con

\author{Carlos CCC \marca{**}}
\afil{Sensei 2 Dojo Cobra Py, https://github.com/CobraPython}%

\alpie{**}{ccc@gmail.com}% Las lineas se cortan automaticamente o puede obligarse esto con

\begin{abstract}
\Resumen
En este art√≠culo se presenta los resultados de tres metodolog√≠as diferentes en las que se aplic√≥ una simulaci√≥n Monte Carlo para estimar el valor de Pi: el m√©todo de comparaci√≥n de √°reas, el m√©todo propuesto por Buffon y la extensi√≥n de Laplace. Los tres casos se desarrollaron en un lenguaje de alto nivel, Python y la librer√≠a Numpy que le otorgan un performance optimizado. Se estudi√≥ con detalle el resultado no determinista de las simulaciones y se demostr√≥ que cumplen con los teoremas fundamentales de la probabilidad.

\descriptores{Simulaci√≥n, Monte Carlo, Pi, Buffon, Buffon-Laplace, Python, Numpy}


\Abstract
This article represents the result of three different metodologies for estimate the pi value with Monte Carlo's simulation: the comparition area's method, el m√©todo propuesto por Buffon y la extensi√≥n de Laplace. The three cases had been developed in  Python ( high level language) and Numpy library which give it an optimized performance. The non-deterministic result of the simulations was studied in detail and it was shown that they comply with the fundamental theorems of probability.

\keywords{Biographies, tributes, personal notes -- Control of chaos, applications of chaos}
\end{abstract}

\maketitle

%%%%%%%%%%%%%%%%%%%%%%%%%%%
%   INTRODUCCION
%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{Introducci√≥n}\label{intro}
El m√©todo de Monte Carlo tiene un g√©nesis moderno en el trabajo pionero de Stan Ulam y John Von Neumann. Luego de la segunda Guerra Mundial aplicaron distintos m√©todos de Monte Carlo en simulaciones para el desarrollo de armas termonucleares. Desde entonces y por m√°s de 50 a√±os que se aplicaron estos desarrollos en la investigaci√≥n y perfeccionamiento de distintos m√©todos que modelan el transporte de neutrones y radiaci√≥n gamma con bastante √©xito experimental\cite{Kling}. 

Hoy resulta una alegre iron√≠a que ning√∫n producto que haya aplicado la metodolog√≠a Monte Carlo en su desarrollo, se haya empleado en conflicto alguno. M√°s a√∫n los cient√≠ficos han explotado el uso de simulaciones Monte Carlo para obtener un beneficio p√∫blico positivo aplic√°ndola en salud. Por ejemplo, los planeamientos de dosis en radioterapia dependen actualmente en alg√∫n grado de c√°lculos obtenidos mediante simulaciones que emplean Monte Carlo.


El m√©todo de Monte Carlo es un m√©todo de resoluci√≥n num√©rica donde se modelan las relaciones e interacciones de distintos objetos y su entorno, mediante la generaci√≥n aleatoria de estas interacciones. Mientras mayor sea la repetici√≥n de pruebas se obtiene un resultado que va convergiendo a un valor con mayor precisi√≥n. Es por el recurso de la aleatoriedad que obtiene el nombre Monte Carlo, pues se inspira en la regi√≥n del Principado de M√≥naco donde se encuentran el casino Monte Carlo.
Un m√©todo Monte Carlo se puede definir de la siguiente forma: <<Los m√©todos Monte Carlo son aqu√©llos en los que las propiedades de las distribuciones de las variables aleatorias son investigadas mediante la simulaci√≥n de n√∫meros aleatorios. Estos m√©todos, dejando a un lado el origen de los datos, son similares a los m√©todos estad√≠sticos habituales en los cuales las muestras aleatorias se utilizan para realizar inferencias acerca de las poblaciones origen. Generalmente, en su aplicaci√≥n estad√≠stica se utiliza un modelo para simular un fen√≥meno que contiene alg√∫n componente aleatorio. En los m√©todos Monte Carlo, por otro lado, el objeto de la investigaci√≥n es un modelo en s√≠ mismo, y se utilizan sucesos aleatorios o pseudoaleatorios para estudiarlo.>>\cite{Gentle}


El m√©todo cobra una especial relevancia las
√∫ltimas d√©cadas debido a que se produjeron
sustanciales y significativos avances respecto a la
potencia de los procesadores y las distintas
arquitecturas inform√°ticas. Es ampliamente usado
en problemas donde obtener un resultado
anal√≠tico no es posible, o en problemas que
contienen demasiada complejidad (como es el
caso de la ecuaci√≥n de transporte de Boltzmann
para part√≠culas sin carga).\cite{Kling}


%%%%%%%%%%%%%%%%%%%%%%%%%%%
%   midelo de simulacion
%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{Modelo de Simulaci√≥n.}
\subsection{Entorno de desarrollo}

Como quedo manifiesto en el anterior punto el m√©todo Monte Carlo tiene una precisi√≥n proporcional a $\frac{1}{\sqrt{N}}$. En comparaci√≥n con otros m√©todos num√©ricos determin√≠stico (como por ejemplo el m√©todo de trapecios o Simpson para encontrar la integral de una funci√≥n definida) que tienen un error de aproximaci√≥n proporcional a $\frac{1}{N^2}$, los m√©todos que aplican Monte Carlo requieren una cantidad considerable mayor de datos a procesar. Sumado este hecho a la complejidad que puede involucrar el modelamiento de las interacciones aleatorias, es que generalmente se prefiere usar lenguajes de programaci√≥n de bajo nivel que permitan minimizar el tiempo de c√≥mputo total.

Por ejemplo, es com√∫n encontrar desarrollos en c, c++ y Fortran entre otros. Existiendo hoy librer√≠as que facilitan la generaci√≥n de n√∫meros pseudoaleatorios y el manejo matem√°tico. A√∫n con esta ventaja el c√≥digo necesario para una aplicaci√≥n final suele ser bastante complicado y extenso.
Estos dos criterios identificados se consideraron para la selecci√≥n del entorno de desarrollo:
1. El tiempo de procesamiento.
2. La legibilidad del c√≥digo.

Siendo Python un lenguaje de alto nivel que cumple con el segundo criterio, al incluir la librer√≠a Numpy (librer√≠a de procesamiento num√©rico para Python) obtenemos una velocidad de procesamiento comparable a C. Adicionalmente se utiliz√≥ una librer√≠a para la representaci√≥n de los datos, Matplotlib.
Se detalla todo el c√≥digo y las dependencias en el repositorio del proyecto:

https://github.com/CobraPython/montecarlopi

\subsection{Generaci√≥n de n√∫meros Pseudeoaleatorios}

Existen distintos m√©todos para la generaci√≥n de n√∫meros aleatorios, sin embargo, la generaci√≥n de estos en ordenador parte necesariamente desde una semilla (seed) que es un valor concedido por el usuario. Con esta semilla se genera una √∫nica serie de n√∫meros aleatorios, pudiendo ser replicados a partir de esta. Por esta raz√≥n es que se denominan n√∫meros pseudo aleatorios.
La librer√≠a Numpy utiliza el algoritmo Mersenne Twistter (MT19937) \cite{Tanguy} para la generaci√≥n de n√∫meros pseudoaleatorios. Este m√©todo particular tiene la cualidad de tener una periodicidad bastante grande en la generaci√≥n de n√∫meros: $2^{19937}‚àí1$\cite{Makoto}.

\subsection{M√©todos de estimaci√≥n de Pi}
\subsubsection{M√©todo Simple para la estimaci√≥n de Pi}

Se propone estimar el n√∫mero de Pi con el siguiente modelo:
Consideramos un cuadrado de lado L, con una circunferencia en su interior de radio L.
La relaci√≥n de √°reas se da en la ecuacion \ref{areaseq}:

\begin{equation}
	\frac{A_{circunferencia}}{A_{cuadrado}}=\frac{\pi L^2}{L^2}
\label{areaseq}	
\end{equation}}

Una forma de calcular esta relaci√≥n de √°reas es lanzar al azar puntos dentro del cuadrado. Estos puntos pueden quedar tambi√©n dentro de la circunferencia, la relaci√≥n de √°reas quedara expresada por aquellos puntos que est√©n dentro del circulo sobre el total.
En la gr√°fica \ref{area} se muestra un ejemplo del experimento propuesto, mostrando un solo cuadrante ya que las √°reas son sim√©tricas en cada eje.

\begin{figure}[htbp!]
 \centering
  \includegraphics[width=0.4\textwidth]{figures/areas.jpg}
	\caption{Representaci√≥n gr√°fica de la estimaci√≥n de Pi mediante el lanzamiento aleatorio de puntos. Mientras mayor sea el n√∫mero de lanzamientos las √°reas son m√°s definidas}
 \label{area}
\end{figure}

Queda bastante ejemplificado que mientras mayor sea el n√∫mero de puntos, las √°reas quedan mejor definidas.
Para obtener esta aproximaci√≥n se necesitan generar los puntos aleatoriamente con una distribuci√≥n uniforme, es decir, con igual probabilidad de caer dentro y fuera del √°rea del cuarto de circunferencia.

\subsection{M√©todo de Buffon para la estimaci√≥n de Pi}

En el caso de la estimaci√≥n de Pi usando la propuesta experimental de Buffon y su extensi√≥n de Laplace tenemos m√°s variables aleatorias a considerar. Puesto que cada aguja cae aleatoriamente con un centro en $(ùë•_ùëñ,ùë¶_ùëñ)$, tiene relacionada otra variable aleatoria que corresponde al √°ngulo de inclinaci√≥n $\theta$ de la aguja. La figura \ref{aguja} nos muestra un ejemplo.



\begin{figure}[tbp!]
 \centering
  \includegraphics[width=0.4\textwidth]{figures/agujas.jpg}
	\caption{Las agujas caen en una posici√≥n y √°ngulo aleatorio. Dependiendo de este √°ngulo se puede determinar si la aguja cruza una l√≠nea.\cite{Statistics}}
 \label{aguja}
\end{figure}

Si bien en este caso se recurre a una funci√≥n trigonom√©trica para evaluar la inclinaci√≥n y considerar a las agujas que cruzan la l√≠nea, el ordenador usa recursivamente el valor de Pi para calcular la funci√≥n coseno, siendo este un error ‚Äúhist√≥rico‚Äù ya que recurre al valor de pi para calcular al mismo. Por esta raz√≥n se us√≥ una correcci√≥n geom√©trica que evita el uso de funciones trigonom√©tricas.

Pasando de requerir generar aleatoriamente un √°ngulo $\theta$, a generar aleatoriamente desplazamientos $\delta x$,$\delta y$. En la siguiente figura se muestra una representaci√≥n gr√°fica de c√≥mo se realiza la simulaci√≥n con un n√∫mero grande de lanzamientos aleatorios con distribuci√≥n uniforme. \cite{Statistics}

Para esta propuesta del lanzamiento de agujas para la estimaci√≥n de Pi, se comparan dos casos:
-Problema Buffon, cuando las agujas cruzan l√≠neas en un solo eje.
-Problema Buffon-Laplace, cuando las agujas cruzan l√≠neas en sentido vertical y horizontal.




\begin{figure}[tbp!]
 \centering
  \includegraphics[width=0.4\textwidth]{figures/buffon.jpg}
	\caption{Representaci√≥n gr√°fica del experimento de Buffon lanzando 2000 agujas.\cite{Statistics}}
 \label{buff}
\end{figure}


En la figura \ref{buff} se puede ver el resultado del lanzamiento de 2000 agujas de largo $a$ de la misma longitud que la separaci√≥n de las lineas $b$, es decir que $a=b$. La probabilidad se calcula en relaci√≥n a cuantas agujas cruzan una l√≠nea sobre el total de agujas. 



\section{Ep√≠logo}\label{epi}
Como el lector habr√° percibido durante la lectura de esta entrevista, la teor√≠a del caos contin√∫a siendo una de las pasiones de JY lo que le permite transmitir de manera did√°ctica los conceptos ligados a la misma. Es uno de los art√≠fices de los conceptos desarrollados por el prestigioso grupo de caos de la universidad de Maryland descrito en \cite{UMD17}, y entre los que tambi√©n se cuentan a Edward Ott, Celso Grebogi, Rajarshi Roy entre otros y tambi√©n a colaboradores dentro de su propia instituci√≥n como Eugenia Kalnay as√≠ como externos, entre los que mencionamos a Jason Gallas\footnote{Tanto Kalnay como Gallas est√°n ligados a la RBF por ser o haber sido parte del Comit√© Editorial.}.

\begin{acknowledgments}
Agradezco al MPIPKS por haber posibilitado mi participaci√≥n en el taller ``Multistability and Tipping: From Mathematics and Physics to Climate and Brain". A Sergio Ya√±ez Pagans (hoy en la Universidad de Arizona) por el excelente trabajo de edici√≥n del v√≠deo de la entrevista y por su permanente entusiasmo en las actividades cient√≠ficas. A Fernando Poma Ajoruro por haber realizado parte de la transcripci√≥n y por la permanente colaboraci√≥n que brinda al Grupo de Sistemas Complejos de la UMSA.
\end{acknowledgments}

\begin{thebibliography}{32}
\expandafter\ifx\csname natexlab\endcsname\relax\def\natexlab#1{#1}\fi


\bibitem[{Wikipedia(2017)}]{WIKI17}
Wikipedia contributors. ``James A. Yorke." Wikipedia, The Free Encyclopedia. Wikipedia, The Free Encyclopedia, Web. 22 Mayo 2017.



\bibitem[{YouTube (2016)}]{YT16}
James Yorke interview by Marcelo Ram√≠rez, Bolivian physicist, https://www.youtube.com/watch?v=cGNMyT6NNT0, Web. 7 Diciembre 2016.
\end{thebibliography}
\end{document} 